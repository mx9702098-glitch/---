# 产品需求文档：村委会数据管理系统

## 一、需求背景

### 需求背景&需求来源

本项目源于用户对村委会数据管理系统的需求，旨在构建一个移动优先、交互友好的数据管理平台。最初的需求是基于一份“数据沉淀与数据维护模块代码”进行产品原型开发。在迭代过程中，用户对功能细节、交互流程和界面风格提出了多项具体要求，逐步完善了系统的核心功能。

当前业务痛点包括：
*   村委会数据管理缺乏统一、便捷的平台，数据收集、整理和维护效率低下。
*   数据冲突处理流程不明确，容易导致数据不一致。
*   缺乏移动端支持，不便于村委会工作人员在外勤时进行数据操作。

需求来源主要为用户提出的具体功能需求和交互优化建议，以及对整体用户体验的持续改进。核心功能包括智能收集（原数据维护）、数据沉淀、数据维护等。

### 需求目标用户，以及用户特点

**目标用户：** 村委会工作人员（“村两委”成员），包括村支书、村主任、村文书等。

**用户特点：**
*   **技术水平：** 可能不具备高技术背景，需要直观、易用的操作界面，降低学习成本。
*   **工作场景：** 工作场景多样，包括办公室和外勤，对移动端操作有较高要求，需要支持离线操作和数据同步。
*   **数据处理：** 需要处理多种类型的数据，如村民户籍档案、土地信息、党建活动数据、任务工作数据等，对数据准确性和同步效率有较高要求。
*   **时间敏感性：** 许多工作具有时效性，需要快速录入和查询数据。

### 需求出发点，以及能够解决的问题

**需求出发点：** 提升村委会数据管理效率，优化数据处理流程，提供便捷的移动端操作体验，最终实现村务管理的数字化和智能化。

**能够解决的问题：**
*   **数据收集与录入效率低下：** 通过“智能收集”模块，提供多种数据导入方式（照片识别、微信聊天选择、文件上传），简化数据录入流程，减少人工误差。
*   **数据冲突处理不规范：** 引入数据冲突处理机制，通过清晰的冲突展示和处理选项，确保数据同步的准确性和一致性，避免数据丢失或重复。
*   **数据维护与管理不便：** 提供“历史表格管理”和“村民户籍档案”模块，方便工作人员查看、编辑和管理数据，实现数据的沉淀和有效利用。
*   **数据共享与利用受限：** 支持数据导出和分享功能，便于数据在不同场景下的应用，促进村务信息的透明化和共享。
*   **移动办公需求：** 提供移动端友好的界面和交互，支持工作人员随时随地进行数据操作，提高外勤工作的效率。

## 二、需求描述

### 流程图，操作步骤，业务逻辑、数据流向、预期表现等

#### 1. 整体业务流程图

以下为村委会数据管理系统的整体业务流程图，详细展示了用户从登录到数据管理、同步、导出的主要操作路径和系统逻辑。

![业务流程图](https://private-us-east-1.manuscdn.com/sessionFile/bNb6Oz2rRO1vT45ksP6we2/sandbox/9hYv1pNdjaXvE6916zYHMX-images_1760349707369_na1fn_L2hvbWUvdWJ1bnR1L2J1c2luZXNzX3Byb2Nlc3NfZGlhZ3JhbQ.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9wcml2YXRlLXVzLWVhc3QtMS5tYW51c2Nkbi5jb20vc2Vzc2lvbkZpbGUvYk5iNk96MnJSTzF2VDQ1a3NQNndlMi9zYW5kYm94LzloWXYxcE5kamFYdkU2OTE2ellITVgtaW1hZ2VzXzE3NjAzNDk3MDczNjlfbmExZm5fTDJodmJXVXZkV0oxYm5SMUwySjFjMmx1WlhOelgzQnliMk5sYzNOZlpHbGhaM0poYlEucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzk4NzYxNjAwfX19XX0_&Key-Pair-Id=K2HSFNDJXOU9YS&Signature=eb9yf6TBAVNB4XYexESqg5KwTNInttnsCq~mn9Q9lW6QFeRzyBbxVCwwXawSsf3losTqa5K-Fugs8Ail3kcCpHWDoD17lfrN2qstW5srSzvhwhxCsM1qq1kRczmDEkKXjZ0R3Am-VIqzSbMMyzMHOVOTZYV-emk~x6VymNIkk9jvH0JPnjBKYrj0DXnafQDydd2yMWqr1OIVj~bsgL9qu4rZcs4yULaT-DQOWKaY-93pDTSIgpQxmvGJHWSWZSgV1Ktin6gwG6rEdtuMYPCorQVzdFSIFKQgv32Sfs3CSIJ-r3jIkmvQ74GRlZcG5IM26g1BU4LFyDj7jSYbSf0Yeg__)

#### 2. 核心功能操作步骤与业务逻辑

**2.1 主页 (入口页面)**
*   **操作步骤：** 用户登录后进入主页。
*   **业务逻辑：** 页面展示个人中心、快捷访问、我的工作台、我的热情值等模块。其中，“我的工作台”将包含“智能收集”入口。
*   **预期表现：** 页面布局和视觉风格严格遵循提供的蓝本图片（`/home/ubuntu/upload/IMG_9638.PNG`），底部导航栏固定。点击“我的工作台”中的“智能收集”入口，跳转至“智能收集”页面，并伴随平滑的页面切换动画。

**2.2 智能收集页面**
*   **操作步骤：** 从主页点击“智能收集”入口进入。
*   **业务逻辑：** 页面包含“历史表格管理”和“村民户籍档案”两个Tab，默认选中“历史表格管理”Tab。
*   **预期表现：** 页面切换流畅，Tab内容根据选择动态展示，Tab切换时有视觉反馈。

**2.3 历史表格管理 (Tab)**
*   **操作步骤：** 默认进入“智能收集”页面后显示此Tab内容。
*   **业务逻辑：**
    *   **搜索任务：** 用户输入关键词（如任务标题、创建人）搜索任务，支持模糊匹配。
    *   **新增任务：** 点击页面右上角的“新增任务”按钮，弹出“导入表格”对话框。
        *   对话框提供“上传照片识别”（模拟拉起相册/相机进行拍照或选择图片）和“从微信聊天选择”（模拟拉起微信聊天记录，选择文件）两个选项。
        *   用户选择导入方式后，系统模拟识别表格标题并填充到“任务标题”输入框，用户可编辑修改。若识别失败，则提供默认标题或提示用户手动输入。
    *   **任务列表：** 展示所有任务卡片，每张卡片包含任务标题、创建日期、创建人员、当前状态（“进行中”、“已完成”、“未同步”、“已同步”）。任务列表支持下拉刷新和上拉加载更多。
    *   **任务卡片操作：**
        *   **查看数据：** 点击任务卡片后，拉起半屏的“任务数据详情”卡片，展示OCR识别后的结构化数据和原始图片。
        *   **导出：** 点击卡片上的“导出”图标，弹出下拉菜单，提供“保存到手机”（导出为Excel文件）和“发送到微信”（分享Excel文件到微信好友或群）选项。
        *   **同步数据：** 针对状态为“未同步”的任务（无论进行中或已完成），点击“同步数据”按钮，弹出“同步数据选项”对话框。
            *   **直接同步平台数据：** 触发数据授权协议须知，用户同意后进入数据冲突处理流程。
            *   **上传修改后同步：** 弹出“上传修改后的表格”对话框（提供“上传本地文件”和“从微信聊天选择”），用户上传新文件后，触发数据授权协议和冲突处理流程。
        *   **已同步：** 针对状态为“已同步”的任务，显示灰色“已同步”按钮，点击无响应或提示已同步。
*   **预期表现：** 任务列表清晰，操作按钮明确，弹窗交互流畅，数据导入和同步过程有明确的加载和结果提示。

**2.4 村民户籍档案 (Tab)**
*   **操作步骤：** 点击“村民户籍档案”Tab进入。
*   **业务逻辑：**
    *   **搜索村民：** 用户输入关键词（如姓名、身份证号、组别）搜索村民，支持模糊匹配。
    *   **新增村民：** 点击页面右上角的“新增村民”按钮，弹出“新增本村村民档案”对话框，用户填写村民姓名、身份证号、电话、组别等信息并提交。提交前进行数据格式校验。
    *   **村民列表：** 展示村民档案卡片，每张卡片包含姓名、身份证、电话、组别、更新日期等关键信息。支持点击卡片查看详情和编辑。
*   **预期表现：** 村民列表清晰，新增村民流程简单直观，数据录入有校验提示。

**2.5 任务数据详情 (半屏卡片)**
*   **操作步骤：** 在“历史表格管理”的任务卡片中点击“查看数据”触发。
*   **业务逻辑：**
    *   **数据汇总：** 以表格形式展示OCR识别后的结构化数据，包含多人的多个字段信息（如姓名、电话、地址等）。表格支持左右滑动查看更多字段。
    *   **数据统计：** 在数据汇总表格下方展示"数据统计"卡片，包含以下内容：
        *   **重复字段统计：** 自动分析上传表格中的重复字段，统计每个字段的重复次数和重复率。
        *   **字段分布展示：** 以可视化图表（柱状图/饼图）展示各字段的数据分布情况。
        *   **数据质量指标：** 显示空值数量、重复值数量、异常值数量等数据质量指标。
        *   **统计维度：** 支持按字段名称、重复次数、出现频率等维度进行排序和筛选。
        *   **详细列表：** 点击统计项可展开查看具体的重复数据明细，包括重复值内容、出现位置（行号）、出现次数等。
    *   **原始图片 (模拟)：** 默认收起，点击“显示原始图片”按钮后展开，支持多张图片左右滑动展示，可进行图片缩放和旋转操作。
    *   **修改数据：** 点击页面底部的“修改数据”按钮，弹出“编辑OCR数据”对话框，允许用户对识别出的数据进行手动修正。修改后点击保存，数据更新并同步至本地。
*   **预期表现：** 数据展示清晰，数据统计卡片提供直观的重复字段分析和可视化展示，图片可折叠和滑动，修改入口明确，数据修改后有保存成功的提示。

**2.6 数据冲突处理 (半屏卡片)**
*   **操作步骤：** 在“同步数据”流程中，用户同意授权后触发。
*   **业务逻辑：**
    *   系统检测到本地数据与平台数据存在冲突时，弹出此半屏卡片。
    *   展示数据冲突列表，每项冲突清晰显示冲突字段、本地旧值和平台新值。
    *   提供“保留旧值”、“采纳新值”和“手动修改”三个处理选项。用户选择后，冲突状态更新。
    *   所有冲突处理完毕后，“处理完成”按钮变为可用，点击后完成数据同步。
*   **预期表现：** 冲突信息明确，处理选项清晰，处理完成后可关闭卡片并返回任务列表，任务状态更新为“已同步”。

### 原型图or交互辅助、字段说明

*   **原型图：** 参考当前部署的Demo页面 (`https://village-data-management-branch-23.manus.im`)。具体UI设计请参照 `/home/ubuntu/upload/IMG_9638.PNG`。
*   **交互辅助：**
    *   **弹窗：** 所有弹窗均采用居中弹出，大小统一 (`sm:max-w-md`)，并支持点击外部区域关闭。
    *   **页面切换：** 页面切换采用平滑过渡动画，提升用户体验。
    *   **Toast 提示：** 操作成功或失败时，页面顶部弹出短暂的Toast提示，自动消失。
    *   **加载状态：** 在数据加载、提交、同步等耗时操作时，显示加载动画或骨架屏，避免页面卡顿。
    *   **空状态：** 列表无数据时，显示友好的空状态提示。
*   **字段说明：**
    *   **任务：** `id` (唯一标识，UUID), `title` (任务标题，字符串), `status` (状态: `active`进行中, `completed`已完成, `unsynced`未同步, `synced`已同步，枚举类型), `createDate` (创建日期，时间戳), `creator` (创建人员，字符串), `synced` (是否已同步: `true`/`false`，布尔类型)
    *   **村民：** `id` (唯一标识，UUID), `name` (姓名，字符串), `idCard` (身份证号，字符串，需校验格式), `phone` (电话，字符串，需校验格式), `group` (组别，字符串), `updateDate` (更新日期，时间戳)
    *   **冲突：** `id` (唯一标识，UUID), `name` (冲突对象姓名，字符串), `type` (冲突类型，枚举类型，如`data_mismatch`), `field` (冲突字段，字符串), `oldValue` (本地旧值，字符串), `newValue` (平台新值，字符串), `resolved` (是否已解决，布尔类型)
    *   **OCR数据：** `id` (唯一标识，UUID), `name` (姓名，字符串), `phone` (电话，字符串), `address` (地址，字符串) (可根据实际表格内容扩展更多字段，如性别、年龄、民族等)

### 涉及的相关系统模块，以及实现优先级

*   **前端展示模块：** (高优先级) - 已完成大部分，需持续优化UI/UX，确保移动端适配和响应式设计。
*   **用户认证模块：** (中优先级) - 登录/注册、权限管理（如村两委成员的增删改查权限、数据操作权限）。需与现有用户系统集成。
*   **数据存储模块：** (高优先级) - 任务数据、村民档案、OCR数据、冲突数据。需设计高效、可靠的数据库结构，支持高并发读写。
*   **OCR识别服务接口：** (高优先级) - 接收图片/文件，返回结构化数据。需考虑服务稳定性、并发能力和识别准确率。
*   **微信接口：** (中优先级) - 微信文件/聊天记录选择、微信分享。需遵循微信开放平台开发规范。
*   **文件上传/下载服务：** (高优先级) - 支持本地文件上传、Excel文件导出。需考虑大文件上传下载的性能和安全性。
*   **数据冲突检测与处理服务：** (高优先级) - 后端逻辑实现，负责比对数据、生成冲突列表、执行冲突处理策略。
*   **通知服务：** (中优先级) - 催办通知、同步结果通知、系统消息推送。可集成短信或站内信服务。

**实现优先级：**
1.  核心功能（智能收集、数据维护、同步冲突处理）的稳定性和交互流畅性，确保基本业务流程可用。
2.  数据准确性与完整性保障，包括数据校验、冲突处理的可靠性。
3.  用户体验优化（动画、响应速度、易用性），提升用户满意度。
4.  AI功能集成与优化，提高OCR识别的准确性和效率。
5.  扩展功能（如村民档案的更多操作、数据看板、数据分析报告）。

### 对其他业务模块可能带来的影响

*   **善治美平台：** 本系统作为善治美平台的数据收集和维护前端，将直接影响其档案管理和数据分析的准确性和及时性。需要与善治美平台的数据模型和接口进行深度集成。
*   **现有数据源：** 数据同步可能需要与村委会现有的其他数据系统进行对接，需考虑数据格式兼容性和迁移方案，可能涉及数据清洗和转换。
*   **用户管理系统：** 需要与用户管理系统集成，实现用户身份验证和权限控制，确保数据安全和操作合规性。
*   **统计分析系统：** 为统计分析系统提供更丰富、更准确的原始数据，支持生成更精细化的村务报告。

## 三、数据上报需求

### 数据埋点需求
*   **事件：**
    *   “智能收集”入口点击：记录用户进入智能收集模块的次数。
    *   “新增任务”按钮点击：记录用户尝试创建新任务的次数。
    *   “上传照片识别”/“从微信聊天选择”操作：记录用户选择不同导入方式的次数及成功率。
    *   “新增村民”按钮点击：记录用户尝试新增村民档案的次数。
    *   “查看数据”按钮点击：记录用户查看任务数据详情的次数。
    *   “修改数据”按钮点击：记录用户对OCR数据进行手动修改的次数。
    *   “导出”操作：记录导出操作的次数，并区分“保存到手机”和“发送到微信”两种方式。
    *   “同步数据”按钮点击：记录同步操作的次数，并区分“直接同步”和“上传修改后同步”两种方式。
    *   “数据授权协议”同意/取消：记录用户对数据授权协议的接受或拒绝情况。
    *   “数据冲突”处理：记录冲突处理的次数，并区分“保留旧值”、“采纳新值”、“手动修改”三种处理方式。
*   **字段：** `user_id` (用户唯一标识), `event_name` (事件名称), `timestamp` (事件发生时间), `task_id` (如果适用，任务唯一标识), `villager_id` (如果适用，村民唯一标识), `action_type` (具体操作类型，如`upload_photo`, `sync_direct`), `result` (操作结果，如`success`/`fail`), `error_message` (如果失败，记录错误信息)。

### 数据统计需求
*   **核心指标：**
    *   每日/每周/每月新增任务数量：反映系统使用活跃度。
    *   每日/每周/每月新增村民档案数量：反映村民信息录入情况。
    *   数据同步成功率：衡量数据同步功能的稳定性。
    *   数据冲突发生率及处理方式分布：分析数据质量问题及用户处理偏好。
    *   各功能模块使用频率：评估各模块的用户粘性和重要性。
    *   OCR识别成功率及准确率：评估AI服务的性能。
*   **报表需求：** 后台管理界面需展示上述指标的趋势图和汇总表，支持按时间范围、用户角色、村组等维度进行筛选和分析。
*   **更新频率：** 实时或每日更新，确保数据分析的及时性。

## 四、AI服务开发需求

### AI功能描述
*   **OCR识别表格：** 接收用户上传的图片或文件（如Excel、PDF扫描件），通过先进的OCR技术识别表格中的结构化数据，并提取关键信息，如姓名、电话、地址、身份证号、家庭成员关系、土地面积等。支持多种表格模板的识别。
*   **表格标题自动识别与生成：** 根据OCR识别出的表格内容，智能分析其主题和关键信息，自动生成一个建议的任务标题，提高用户创建任务的效率。
*   **数据校验与补全：** 对OCR识别出的数据进行初步校验，如身份证号格式、电话号码格式等，并尝试根据上下文进行智能补全。

### 效果预期
*   **OCR识别准确率：** 关键字段（如姓名、身份证号）识别准确率达到95%以上，其他字段识别准确率达到90%以上。
*   **表格标题生成：** 自动生成的标题应具有高相关性和可读性，用户编辑率低于20%。
*   **响应时间：** OCR识别和标题生成在3秒内完成，对于复杂表格，最长不超过5秒。
*   **容错性：** 能够处理一定程度的图片倾斜、模糊、光照不均等情况。

### 训练数据和模型要求
*   **训练数据：** 大量村委会相关的表格图片和扫描件，包含不同版式、字体、清晰度和数据密度的样本，并进行人工标注，确保数据多样性和准确性。数据来源包括历史档案、调研问卷等。
*   **模型要求：** 具备多语言（中文）识别能力，对表格结构有良好理解，支持自定义字段提取和模板学习。模型应具备持续学习和优化的能力，能够根据新的数据不断提升性能。

## 五、周边接口影响说明

### 外部接口依赖
*   **OCR服务接口：** 调用第三方（如百度AI开放平台、腾讯云AI）或自研的OCR服务API。需评估其稳定性、并发能力、成本和数据安全性。
*   **微信开放平台接口：** 用于实现微信文件/聊天记录选择、微信分享功能。需要申请相应的接口权限。
*   **善治美平台API：** 用于数据同步至善治美平台。需要详细了解其API文档，包括认证方式、数据格式、限流策略等。
*   **文件存储服务：** 用于存储用户上传的原始图片和识别后的数据，可采用云存储服务（如阿里云OSS、腾讯云COS）。

### 对外接口影响
*   本系统主要作为善治美平台的数据输入端，对善治美平台的现有API可能需要进行适配或扩展，以支持新的数据类型和同步逻辑。可能需要新增数据同步接口或修改现有接口的数据结构。
*   未来可能需要对外提供数据查询或统计接口，供其他村务管理系统调用。

## 六、其他需关注的信息

### 技术约束和限制
*   **移动端优先：** 界面和交互需充分考虑移动端设备的特性和性能，采用响应式设计，兼容不同尺寸的手机和平板设备。
*   **数据安全与隐私：** 严格遵守数据保护法律法规（如《个人信息保护法》），确保用户数据安全。所有敏感数据（如身份证号、电话）需进行加密传输和存储，并实施严格的访问控制。
*   **性能：** 页面加载、数据查询和同步操作需保持流畅，响应时间短。尤其是在网络条件不佳的农村地区，需优化离线缓存和数据同步机制。
*   **可扩展性：** 系统架构需具备良好的可扩展性，采用微服务或模块化设计，便于未来新增功能和模块，如增加更多数据类型、集成更多AI能力。
*   **兼容性：** 需兼容主流移动浏览器（如微信内置浏览器、Safari、Chrome Mobile）。

### 时间节点和里程碑
*   **阶段一：核心功能开发与优化 (当前阶段)**
    *   完成主页、智能收集、历史表格管理、村民户籍档案等核心模块的UI/UX和基本交互。
    *   完成数据同步、冲突处理、数据详情查看等流程的初步实现。
    *   **预计完成时间：** 2025年11月15日。
*   **阶段二：AI功能集成与优化**
    *   集成OCR识别和表格标题自动生成功能，并进行初步测试。
    *   优化AI识别准确率和响应速度，进行模型调优。
    *   **预计完成时间：** 2025年12月31日。
*   **阶段三：系统集成与测试**
    *   与善治美平台、微信等外部接口进行联调测试，确保数据流转顺畅。
    *   进行全面的功能测试、性能测试、安全测试和用户验收测试（UAT）。
    *   **预计完成时间：** 2026年1月31日。
*   **阶段四：上线部署与持续优化**
    *   系统正式上线部署，并进行线上监控和维护。
    *   根据用户反馈和数据分析，持续进行功能迭代和性能优化。
    *   **预计完成时间：** 2026年2月28日。

### 验收标准
*   所有功能模块均可正常使用，无明显Bug，满足产品需求文档中描述的所有功能点。
*   UI/UX严格遵循设计稿和用户反馈，交互流畅，无卡顿，移动端适配良好。
*   数据同步和冲突处理逻辑正确，数据一致性得到保障，无数据丢失或错误。
*   AI识别准确率达到预期目标，表格标题生成符合要求。
*   系统性能满足移动端使用要求，页面加载速度快，操作响应及时。
*   通过安全审计，无明显安全漏洞，数据传输和存储符合安全规范。
*   用户满意度达到85%以上（通过用户调研评估）。

### 相关文档和资源
*   **设计稿：** (当前Demo页面作为参考，`/home/ubuntu/upload/IMG_9638.PNG`为主要参考图)。
*   **API文档：** 善治美平台API文档、OCR服务API文档、微信开放平台文档。
*   **技术规范：** 前后端开发规范、安全规范、数据存储规范。
*   **用户调研报告：** 包含用户需求、痛点和期望的详细分析。
*   **竞品分析报告：** 对同类产品的优劣势进行分析，为本系统提供参考。

**作者：** Manus AI
**日期：** 2025年10月13日
